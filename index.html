<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Easy ML Image Classifier</title>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.14.0"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>

<style>
body{
  background:#0b1220;
  color:white;
  font-family:system-ui;
  padding:20px;
}
h2{margin-top:0}
input,button,select{
  padding:8px;
  margin-top:6px;
  border-radius:8px;
  border:none;
  font-size:14px;
  box-sizing:border-box;
  transition: 0.3s;
}
input.classNameInput{
  background:white;
  color:black;
  width:100%;
}
button{cursor:pointer; transition:0.3s;}
button:hover,input:hover,select:hover{
  box-shadow:0 0 10px currentColor;
}
.card{
  padding:14px;
  border-radius:14px;
  margin-bottom:14px;
}
.small{font-size:12px;opacity:.7}
.row{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;}
.row > *{flex:1;}
.progressbg{
  background:#1e293b;
  height:14px;
  border-radius:10px;
  overflow:hidden;
  margin-top:8px;
}
.progress{height:14px;width:0;background:#22c55e;transition:.2s}
.barbg{
  background:#1e293b;
  border-radius:8px;
  overflow:hidden;
  margin-top:6px;
}
.bar{
  height:18px;
  display:flex;
  align-items:center;
  justify-content:flex-end;
  padding-right:6px;
  font-size:12px;
  color:white;
  text-shadow:1px 1px 2px black;
}
.classname{
  padding:6px;
  border-radius:6px;
  margin-bottom:6px;
  font-weight:bold;
  text-align:center;
}
select option{
  color:white;
}
</style>
</head>
<body>

<h2>ðŸ§  Easy Image Classifier</h2>

<input id="classInput" class="classNameInput" placeholder="Class name">
<button id="addBtn" style="background:#3b82f6; color:white" onclick="addClass()">âž• Add Class</button>

<div id="classList"></div>

<button id="trainBtn" style="background:#3b82f6; color:white" onclick="train()">ðŸš€ Train Model</button>
<div class="progressbg"><div id="prog" class="progress"></div></div>
<div id="status"></div>

<h3>Test Image</h3>
<input id="testInput" type="file" accept="image/*" style="background:#3b82f6; color:white" onchange="testImage(event)">
<div id="results"></div>

<script>
let net, classifier
let classes=[]

const PRESETS=[
  {name:"Green", shades:["#1f4d2b","#236635","#2b7a3b"]},
  {name:"Blue", shades:["#1e40af","#1e3a8a","#1e3a9f"]},
  {name:"Orange", shades:["#b45309","#c76a0d","#d97706"]},
  {name:"Red", shades:["#991b1b","#b91c1c","#dc2626"]},
  {name:"Purple", shades:["#6b21a8","#7e22ce","#9333ea"]}
]

function addClass(){
  const name=document.getElementById("classInput").value.trim()
  if(!name) return alert("Enter class name")
  classes.push({name,images:[],preset:0,shade:0})
  document.getElementById("classInput").value=""
  render()
}

function deleteClass(i){classes.splice(i,1);render()}
function wipeImages(i){classes[i].images=[];render()}
function deleteLastImage(i){classes[i].images.pop();render()}
function setPreset(ci,pi,shade=0){classes[ci].preset=pi;classes[ci].shade=shade;render()}

function render(){
  const classList=document.getElementById("classList")
  classList.innerHTML=""
  classes.forEach((c,i)=>{
    const color=PRESETS[c.preset].shades[c.shade]
    classList.innerHTML+=`
    <div class="card" style="background:${color}33">
      <div class="classname" style="background:${color}; color:white">${c.name}</div>
      <div class="small">${c.images.length} images</div>

      <input type="file" accept="image/*" multiple style="background:${color}; color:white; width:100%; box-shadow:0 0 5px ${color}" onchange="addImages(event,${i})">

      <div class="row">
        <button style="background:${color}; color:white; box-shadow:0 0 5px ${color}" onclick="deleteLastImage(${i})">Delete Last</button>
        <button style="background:${color}; color:white; box-shadow:0 0 5px ${color}" onclick="wipeImages(${i})">Wipe All</button>
        <button style="background:${color}; color:white; box-shadow:0 0 5px ${color}" onclick="deleteClass(${i})">Delete Class</button>
      </div>

      <div class="row">
        <select style="background:${color}; color:white; box-shadow:0 0 5px ${color}" onchange="setPreset(${i},this.value,this.selectedIndex)">
          ${PRESETS.map((p,pi)=>{
            const firstShade=p.shades[0]
            return `<option value="${pi}" style="background:${firstShade}; color:white">${p.name}</option>`
          }).join("")}
        </select>
      </div>
    </div>`
  })
}

function addImages(e,i){
  for(const f of e.target.files){
    const img=new Image()
    img.onload=()=>{classes[i].images.push(img);render()}
    img.src=URL.createObjectURL(f)
  }
}

async function train(){
  if(classes.length<2) return alert("Need 2+ classes")
  if(classes.some(c=>c.images.length<5)) return alert("Each class needs 5+ images")
  document.getElementById("status").textContent="Loading model..."
  if(!net) net=aw
